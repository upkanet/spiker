<html>

<head>
    <title>Axorus - Spiker - FT</title>
</head>
<style>
    body {
        background-color: black;
    }
</style>
<script src="js/jquery3.5.1.min.js"></script>
<script src="js/plotly-latest.min.js"></script>
<script src="js/fili.min.js"></script>
<script src="js/math.min.js"></script>
<script>
    var layoutBlack = { paper_bgcolor: 'black', plot_bgcolor: 'black', font: { color: 'white' }, xaxis: {'title': ''}, xaxis: {ticksuffix:''} };
    var period = 0;
    var fk0 = 0;
    getPeriod();

    function load() {
        $.getJSON('/data', function (data) {
            var d = {x: data.map((x,index) => index * period), y: data.map(x => x), type: 'line' };
            layoutBlack.xaxis.title = 'time';
            layoutBlack.xaxis.ticksuffix = 's';
            Plotly.newPlot('gElectrode', [d], layoutBlack);
        });
    }

    function loadSpectrum() {
        $.getJSON('/spectrum', function (data) {
            var N = data.length;
            //var d = {y: data.map(x => x), type: 'line' };
            var d = {x: data.map((x,k) => k / (2 * N * period)), y: data.map(x => x), type: 'line' };
            layoutBlack.xaxis.title = 'frequency';
            layoutBlack.xaxis.ticksuffix = 'Hz';
            Plotly.newPlot('gSpectrum', [d], layoutBlack);
        });
    }

    function getPeriod(){
        $.getJSON('/period', function (data) {
            period = data;
            load();
            loadSpectrum();
        });
    }
    
</script>

<body>
    <div id="gElectrode" style="width:100%;height:50%;"></div>
    <div id="gSpectrum" style="width:100%;height:50%;"></div>
</body>

</html>